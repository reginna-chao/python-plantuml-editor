<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>PlantUML 網頁轉譯範例</title>
  </head>
  <body>
    <h1>PlantUML 網頁轉譯範例</h1>

    <p>以下是一個使用 PlantUML Web 服務動態生成的時序圖：</p>

    <textarea id="plantuml_source">
 @startuml
Alice -> Bob: Authentication Request
Bob --> Alice: Authentication Response
@enduml
    </textarea>

    <div>
      <button onclick="generatePlantUML()">Submit</button>
    </div>

    <div id="plantuml_diagram"></div>

    <script src="https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js"></script>

    <script>
      const sourceElement = document.getElementById('plantuml_source');
      const diagramContainer = document.getElementById('plantuml_diagram');

      function generatePlantUML() {
        diagramContainer.innerHTML = '';

        // 取得 PlantUML 程式碼
        const plantumlCode = sourceElement.value.trim();

        // 使用 plantuml-encoder 進行編碼
        const encodedCode = plantumlEncoder.encode(plantumlCode);

        // 建立圖片的 URL。選擇 PNG 或 SVG，這裡使用 SVG
        const imageUrl = `https://www.plantuml.com/plantuml/svg/${encodedCode}`;

        // 建立一個 <img> 標籤並設定其 src 屬性
        const img = document.createElement('img');
        img.src = imageUrl;
        img.alt = 'PlantUML Diagram';

        // 將圖片添加到網頁中
        diagramContainer.appendChild(img);
      }

      document.addEventListener('DOMContentLoaded', function () {
        generatePlantUML();
      });
    </script>
  </body>
</html>
